<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <title>MArcGIS DEMO</title>



    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/jquery-ui.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/jquery-ui.structure.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/jquery-ui.theme.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/demo.css' %}" />

    <script src="{% static 'js/jquery.js' %}"></script>
    <script src="{% static 'js/bootstrap.js' %}"></script>
    <script src="{% static 'js/jquery-ui.js' %}"></script>
    <script src="{% static 'js/demo-option.js' %}"></script>
    <script src="{% static 'js/demo-jquery.js' %}"></script>
    <script src="{% static 'js/demo-blockfunc.js' %}"></script>
    <script src="{% static 'js/demo-jquery-ui.js' %}"></script>

    <link rel="stylesheet" href="https://js.arcgis.com/4.3/esri/css/main.css">
    <script src="https://js.arcgis.com/4.3/"></script>

    <script type="text/javascript">
    require([
        "esri/Map",
        "esri/views/SceneView",
        "esri/views/MapView",

        "esri/Graphic",
        "esri/geometry/Point",
        "esri/symbols/SimpleMarkerSymbol",
        "esri/geometry/Polyline",
        "esri/symbols/SimpleLineSymbol",
        "esri/geometry/Polygon",
        "esri/symbols/SimpleFillSymbol",

        "esri/symbols/PointSymbol3D",
        "esri/symbols/ObjectSymbol3DLayer",
        "esri/symbols/WebStyleSymbol",

        "esri/core/watchUtils",
        "esri/widgets/Expand",
        "esri/widgets/BasemapGallery",

        "dojo/dom",
        "dojo/query",
        "dojo/on",
        "dojo/promise/all",
        "dojo/domReady!"

    ], function (Map, SceneView, MapView,
                 Graphic, Point, SimpleMarkerSymbol, Polyline, SimpleLineSymbol, Polygon, SimpleFillSymbol,
                 PointSymbol3D,ObjectSymbol3DLayer,WebStyleSymbol,
                 watchUtils, Expand, BasemapGallery,
                 dom, query, on, all)
    {

        // Create a Map with a basemap, to be used with in the main view
        var mainMap = new Map({
            basemap: "hybrid",
            ground: "world-elevation"
        });

        // Create another Map, to be used in the overview "view"
        var overviewMap = new Map({
            basemap: "streets"
        });

        // Create the SceneView
        var mainView = new SceneView({
            container: "viewDiv",
            map: mainMap,
            camera: {
                position: {
                    x: 107,
                    y: 21,
                    z: 9000000
                },
                tilt: 10,
                heading: 0
            }

        });


        // 1-1.Create a point
        var areapoint_BL = new Point(
                {longitude: 114.1970, latitude: 23.1257}
        );


        var areapoint_ZJK = new Point(
                {longitude: 114.92658, latitude: 40.81462}
        );
        var areapoint_ZG = new Point(
                {longitude: 126.72743, latitude: 48.05202}
        );
        var areapoint_XJ = new Point(
                {longitude: 87.30802, latitude: 43.90181}
        );
        // 1-2.Create a symbol for drawing the point
        var markerSymbol = new SimpleMarkerSymbol({
            color: [226, 119, 40],
            outline: {
                color: [255, 255, 255],
                width: 1
            }
        });

        /*
        *
        *
        *
        *
        * */
        var webStyleSymbol_tree = new WebStyleSymbol({
            name: "Phoenix",
            portal: {
            url: "https://www.arcgis.com"
            },
            styleName: "EsriRealisticTreesStyle"
        });
        var webStyleSymbol_illtree = new WebStyleSymbol({
            name: "Other",
            portal: {
            url: "https://www.arcgis.com"
            },
            styleName: "EsriRealisticTreesStyle"
        });

        function add_ill_tree(lng,lat){
            var tp = new Point({longitude: lng, latitude: lat});
            var webStyleSymbol_ill = new WebStyleSymbol({
                name: "Other",
                portal: {
                url: "https://www.arcgis.com"
                },
                styleName: "EsriRealisticTreesStyle"
            });
            var sur = Math.round(Math.random()*3000)/100;
            var attr_tree = {
                lng: lng,
                lat: lat,
                survive: sur
            };
            // Create pop-up template
            var popupTemp_tree = {
                title: "病树位置",
                content: "<h5>经度：<b>{lng}</b></h5>" +
                "<h5>纬度：<b>{lat}</b></h5>" +
                "<h5>存活概率：<b>{survive}%</b></h5>"
            };
            var ptGra = new Graphic({
                geometry: tp,
                symbol: webStyleSymbol_ill,
                attributes: attr_tree,
                popupTemplate: popupTemp_tree
            });
            mainView.graphics.add(ptGra);

        }


        var symbol = new PointSymbol3D({
            symbolLayers: [new ObjectSymbol3DLayer({
                width: 5,  // diameter of the object from east to west in meters
                height: 20,  // height of the object in meters
                depth: 15,  // diameter of the object from north to south in meters
                resource: { primitive: "cylinder" },
                material: { color: "red" }
            })]
        });


        // Create attributes
        var attr_BL = {
            Area: "博罗县罗阳镇",
            Hectare: "8920公顷",
            Info: "农林用地8920公顷，有林面积8533公顷，种植率97.5%，绿化率80.8%，覆盖率45.1%。" +
            "完成天然林管护和生态公益林改造，其中，实施林管护面积2500亩、生态公益林改造面积2500亩、" +
            "育林木苗5.5万株、义务植树5.5万株。粮食种植面积2.8万亩，农作物播种面积6.69万亩。"
        };
        var attr_ZJK = {
            Area: "张家口市",
            Hectare: "250万公顷",
            Info: "耕地932203.72公顷，园地143925.11公顷，林地1101076.65公顷，草地242304.05公顷，其它农用地80427.44公顷"
        };
        var attr_ZG = {
            Area: "赵光农场",
            Hectare: "46.39万公顷",
            Info: "耕地面积28400公顷，草原面积6070公顷，林地面积3000公顷，水面700公顷。" +
            "人口3万人，11个农业管理区，配套农机具2000余台，农机总动力5.5万千瓦，田间综合机械化程度95%以上"
        };
        var attr_XJ = {
            Area: "新疆生产建设兵团",
            Hectare: "745.63万公顷",
            Info: "2012年统计，农用土总面积419.86万公顷，" +
            "其中耕地104.31万公顷，园地6.52万公顷，林地44.39万公顷，牧草地242.65万公顷，" +
            "建设用地21.05万公顷，未利用地304.72万公顷，其他农用地21.99万公顷"
        };
        // Create pop-up template
        var popupTemp_BL = {
            title: "{Area}",
            content: "<h3>林地面积：<b>{Hectare}</b></h3>"+
                    "相关信息：<p>{Info}</p>"
        };
        var popupTemp_ZJK = {
            title: "{Area}",
            content: "<h3>农用地面积：<b>{Hectare}</b></h3>"+
                    "相关信息：<p>{Info}</p>"
        };
        var popupTemp_ZG = {
            title: "{Area}",
            content: "<h3>土地面积：<b>{Hectare}</b></h3>"+
                    "相关信息：<p>{Info}</p>"
        };
        var popupTemp_XJ = {
            title: "{Area}",
            content: "<h3>土地面积：<b>{Hectare}</b></h3>"+
                    "相关信息：<p>{Info}</p>"
        };
        // 1-3.Create a graphic and add the geometry and symbol to it
        var pointGraphic_BL = new Graphic({
            geometry: areapoint_BL,
            symbol: markerSymbol,
            attributes: attr_BL,
            popupTemplate: popupTemp_BL
        });
        var pointGraphic_ZJK = new Graphic({
            geometry: areapoint_ZJK,
            symbol: markerSymbol,
            attributes: attr_ZJK,
            popupTemplate: popupTemp_ZJK
        });
        var pointGraphic_ZG = new Graphic({
            geometry: areapoint_ZG,
            symbol: markerSymbol,
            attributes: attr_ZG,
            popupTemplate: popupTemp_ZG
        });
        var pointGraphic_XJ = new Graphic({
            geometry: areapoint_XJ,
            symbol: markerSymbol,
            attributes: attr_XJ,
            popupTemplate: popupTemp_XJ
        });

        // 1-4.Add the graphic to the view
        mainView.graphics.add(pointGraphic_BL);
        mainView.graphics.add(pointGraphic_ZJK);
        mainView.graphics.add(pointGraphic_ZG);
        mainView.graphics.add(pointGraphic_XJ);

        /*
            Area Outline
         */

        // 3-1.Create a polygon geometry
        var BL_N = 23.130875645889883;
        var BL_S = 23.121166927809885;
        var BL_E = 114.20237471986587;
        var BL_W = 114.19187761906588;
        var area_BL = [[BL_W, BL_N],[BL_E, BL_N], [BL_E, BL_S],[BL_W, BL_S]];

        var A_BL_W = 114.19187761906588,A_BL_E = 114.19893,A_BL_N = 23.130875645889883,A_BL_S = 23.12645;
        var A_lng_diff = A_BL_E - A_BL_W;
        var A_lng1 = A_BL_W;
        var A_lng2 = A_BL_W + A_lng_diff/4;
        var A_lng3 = A_BL_W + A_lng_diff/2;
        var A_lng4 = A_BL_E - A_lng_diff/4;
        var A_lng5 = A_BL_E;
        var A_lat_diff = A_BL_N - A_BL_S;
        var A_lat1 = A_BL_N;
        var A_lat2 = A_BL_N - A_lat_diff/3;
        var A_lat3 = A_BL_S + A_lat_diff/3;
        var A_lat4 = A_BL_S;
        var p_BL_A =[
            [(A_lng2+A_lng3)/2,(A_lat2+A_lat3)/2],
            [A_lng1,A_lat1],[A_lng2,A_lat1],[A_lng3,A_lat1],[A_lng4,A_lat1],
            [A_lng5,A_lat1],[A_lng1,A_lat2],[A_lng2,A_lat2],[A_lng3,A_lat2],
            [A_lng4,A_lat2],[A_lng5,A_lat2],[A_lng1,A_lat3],[A_lng2,A_lat3],
            [A_lng3,A_lat3],[A_lng1,A_lat4],[A_lng2,A_lat4],[A_lng5,A_lat4]
        ];
        var block_BL_A = [[A_lng1,A_lat1],[A_lng5,A_lat1] , [A_lng4,A_lat2],[A_lng3,A_lat2] ,[A_lng2,A_lat3] ,[A_lng1,A_lat4]];
        var Comprt_BL_A =[
            [p_BL_A[1],p_BL_A[2],p_BL_A[7],p_BL_A[6]],
            [p_BL_A[2],p_BL_A[3],p_BL_A[8],p_BL_A[7]],
            [p_BL_A[3],p_BL_A[4],p_BL_A[9],p_BL_A[8]],
            [p_BL_A[4],p_BL_A[5],p_BL_A[9]],
            [p_BL_A[6],p_BL_A[7],p_BL_A[12],p_BL_A[11]],
            [p_BL_A[7],p_BL_A[8],p_BL_A[12]],
            [p_BL_A[11],p_BL_A[12],p_BL_A[14]]
        ];

        var B_BL_W = 114.19814,B_BL_E = 114.20238,B_BL_N = 23.12593 ,B_BL_S = 23.12119;
        var B_lng_diff = B_BL_E - B_BL_W;
        var B_lng1 = B_BL_W;
        var B_lng2 = B_BL_W + B_lng_diff/2;
        var B_lng3 = B_BL_E;
        var B_lat_diff = B_BL_N - B_BL_S;
        var B_lat1 = B_BL_N;
        var B_lat2 = B_BL_N - B_lat_diff/3;
        var B_lat3 = B_BL_S + B_lat_diff/3;
        var B_lat4 = B_BL_S;

		var p_BL_B =[
			[],
			[B_lng1,B_lat1],[B_lng2,B_lat1],[B_lng3,B_lat1],[B_lng1,B_lat2],
			[B_lng2,B_lat2],[B_lng3,B_lat2],[B_lng1,B_lat3],[B_lng2,B_lat3],
			[B_lng3,B_lat3],[B_lng1,B_lat4],[B_lng2,B_lat4],[B_lng3,B_lat4]
		];
        var block_BL_B = [[B_lng1,B_lat2],[B_lng2,B_lat2],[B_lng2,B_lat1],[B_lng3,B_lat1],[B_lng3,B_lat4],[B_lng1,B_lat4]];
		var Comprt_BL_B =[
			[p_BL_B[2],p_BL_B[3],p_BL_B[6],p_BL_B[5]],
			[p_BL_B[4],p_BL_B[5],p_BL_B[8],p_BL_B[7]],
			[p_BL_B[5],p_BL_B[6],p_BL_B[9],p_BL_B[8]],
			[p_BL_B[7],p_BL_B[8],p_BL_B[11],p_BL_B[10]],
			[p_BL_B[8],p_BL_B[9],p_BL_B[12],p_BL_B[11]]
		];


        var C_BL_W = 114.19444,C_BL_E = 114.1969,C_BL_N = 23.12557 ,C_BL_S = 23.12121;
        var C_lng1 = C_BL_W;
        var C_lng2 = C_BL_E;
        var C_lat_diff = C_BL_N - C_BL_S;
        var C_lat1 = C_BL_N;
        var C_lat2 = C_BL_N - C_lat_diff/3;
        var C_lat3 = C_BL_S + C_lat_diff/3;
        var C_lat4 = C_BL_S;
        var block_BL_C = [[C_BL_W, C_BL_N],[C_BL_E, C_BL_N], [C_BL_E, C_BL_S],[C_BL_W, C_BL_S]];
		var p_BL_C =[
			[],
			[C_lng1,C_lat1],[C_lng2,C_lat1],[C_lng1,C_lat2],[C_lng2,C_lat2],
			[C_lng1,C_lat3],[C_lng2,C_lat3],[C_lng1,C_lat4],[C_lng2,C_lat4]
		];
		var Comprt_BL_C =[
			[p_BL_C[1],p_BL_C[2],p_BL_C[4],p_BL_C[3]],
			[p_BL_C[3],p_BL_C[4],p_BL_C[6],p_BL_C[5]],
			[p_BL_C[5],p_BL_C[6],p_BL_C[8],p_BL_C[7]]
		];

        var area_ZJK=[
                    [114.91556, 40.83407], [114.9206, 40.82907], [114.93481, 40.82892], [114.9395, 40.81355],
                    [114.93997, 40.80289], [114.93163, 40.79631], [114.91875, 40.80021], [114.91501,40.80003]
                ];
        var p_ZJK_A =[
            [126.8969, 48.0806 ],//marker coordinate
            [114.9272, 40.82804],[114.92915, 40.82825],[ 114.92839, 40.82753 ],[ 114.92603, 40.8269],//4
            [114.93104, 40.82845],[114.92908, 40.82599],[114.92571, 40.82519],[114.929, 40.82898],//8
            [114.93463, 40.82889],[114.9324, 40.828]
        ];
        var block_ZJK_A = [ [114.9272, 40.82804],[114.92915, 40.82825],[114.929, 40.82898],[114.93463, 40.82889],
            [114.9324, 40.828],[114.93104, 40.82845],[114.92908, 40.82599],[114.92571, 40.82519],[ 114.92603, 40.8269]];
        var Comprt_ZJK_A = [
            [p_ZJK_A[8],p_ZJK_A[9],p_ZJK_A[10],p_ZJK_A[5],p_ZJK_A[2]],
			[p_ZJK_A[2],p_ZJK_A[5],p_ZJK_A[10],p_ZJK_A[6],p_ZJK_A[3]],
            [p_ZJK_A[4],p_ZJK_A[3],p_ZJK_A[6],p_ZJK_A[7]],
            [p_ZJK_A[1],p_ZJK_A[2],p_ZJK_A[3],p_ZJK_A[4]]
        ];

        var area_ZG =[[126.26, 48.12], [127.6, 48.12], [127.6, 47.54], [126.26,47.54]];
        var p_ZG_A =[
            [126.8969, 48.0806 ],//marker coordinate
            [126.88798, 48.09334],[126.89705, 48.08987],[126.91361, 48.08336 ],[126.90547, 48.0781],//4
            [126.90072, 48.071 ],[126.89507, 48.07082],[126.88173, 48.07056],[126.87876, 48.08402],//8
            [126.8867, 48.08545],[126.88931, 48.08438],[126.89092, 48.08386],[126.88134, 48.07228],//12
            [126.90848, 48.07911],[126.88794, 48.08742]//14
        ];
        var block_ZG_A = [p_ZG_A[1],p_ZG_A[2],p_ZG_A[3],p_ZG_A[13],p_ZG_A[4],p_ZG_A[5],p_ZG_A[6],
            p_ZG_A[7],p_ZG_A[12],p_ZG_A[8],p_ZG_A[10],p_ZG_A[9],p_ZG_A[14]];
        var Comprt_ZG_A = [
            [p_ZG_A[1],p_ZG_A[2],p_ZG_A[11],p_ZG_A[10],p_ZG_A[9],p_ZG_A[14]],
            [p_ZG_A[2],p_ZG_A[3],p_ZG_A[13],p_ZG_A[4],p_ZG_A[11]],
            [p_ZG_A[8],p_ZG_A[10],p_ZG_A[12]],
            [p_ZG_A[10],p_ZG_A[11],p_ZG_A[6],p_ZG_A[7],p_ZG_A[12]],
            [p_ZG_A[11],p_ZG_A[4],p_ZG_A[5],p_ZG_A[6]]
        ];
        var p_ZG_B =[
            [ 126.44993, 48.04765 ],//marker coordinate
            [ 126.44237, 48.04807],[ 126.44554, 48.0487],[126.45015, 48.0501 ],[ 126.45559, 48.05147 ],//4
            [ 126.44235, 48.04651],[ 126.44607, 48.04612],[126.45114, 48.04537],[126.45737, 48.04428]
        ];
        var block_ZG_B = [p_ZG_B[1],p_ZG_B[2],p_ZG_B[3],p_ZG_B[4],p_ZG_B[8],p_ZG_B[7],p_ZG_B[6],p_ZG_B[5]];
        var Comprt_ZG_B = [
            [p_ZG_B[1],p_ZG_B[2],p_ZG_B[6],p_ZG_B[5]],
            [p_ZG_B[2],p_ZG_B[3],p_ZG_B[7],p_ZG_B[6]],
            [p_ZG_B[3],p_ZG_B[4],p_ZG_B[8],p_ZG_B[7]]
        ];

		var area_XJ =[[87.30045, 43.92108],[87.32227, 43.91261],[87.30791, 43.88506],[87.30213, 43.88718]];
        var p_XJ_A =[
            [],//marker coordinate
            [87.30196, 43.90481],[87.30434, 43.90483],[87.3019, 43.90048],[87.30982, 43.904251],//4
            [87.31095, 43.90375],[87.30879, 43.8999],[87.31384, 43.90316],[87.3119, 43.8996],[ 87.30158, 43.90432]
        ];
        var block_XJ_A = [p_XJ_A[1],p_XJ_A[2],p_XJ_A[4],p_XJ_A[5],p_XJ_A[7],p_XJ_A[8],p_XJ_A[6],p_XJ_A[3],p_XJ_A[9]];
        var Comprt_XJ_A = [
            [p_XJ_A[1],p_XJ_A[2],p_XJ_A[3],p_XJ_A[9]],
            [p_XJ_A[2],p_XJ_A[4],p_XJ_A[5],p_XJ_A[6],p_XJ_A[3]],
            [p_XJ_A[5],p_XJ_A[7],p_XJ_A[8],p_XJ_A[6]]
        ];



        // 3-2.Create a symbol for rendering the graphic
        // 3-3.Add the geometry and symbol to a new graphic

        // 3-4.Add the graphic to the view
        function add_polygon_area(cur_area){
            var fillSymbol_area = new SimpleFillSymbol({
                color: [255, 127, 36, 0.5],
                outline: {
                    color: [255, 255, 255],
                    width: 1
                }
            });
            var temp_polygon_area = new Polygon({
                rings: [cur_area]
            });
            var temp_polygonGraphic_area = new Graphic({
                geometry: temp_polygon_area,
                symbol: fillSymbol_area
            });
            mainView.graphics.removeAll();
            mainView.graphics.add(temp_polygonGraphic_area);
        }

        function add_polygon_block(cur_block){
            var fillSymbol_block = new SimpleFillSymbol({
                color: [0, 191, 255, 0.2],
                outline: {
                    color: [65, 105, 225],
                    width: 2
                }
            });
            var temp_polygon_block = new Polygon({
                rings: [cur_block]
            });
            var temp_polygonGraphic_block = new Graphic({
                geometry: temp_polygon_block,
                symbol: fillSymbol_block
            });
            mainView.graphics.removeAll();
            mainView.graphics.add(temp_polygonGraphic_block);
        }
        function add_polygon_block_nocolor(cur_block){
            var fillSymbol_block = new SimpleFillSymbol({
                color: [0, 0, 0, 0],
                outline: {
                    color: [65, 105, 225],
                    width: 2
                }
            });
            var temp_polygon_block = new Polygon({
                rings: [cur_block]
            });
            var temp_polygonGraphic_block = new Graphic({
                geometry: temp_polygon_block,
                symbol: fillSymbol_block
            });
            mainView.graphics.removeAll();
            mainView.graphics.add(temp_polygonGraphic_block);
        }
        function add_polygon_comprt(cur_block,cur_comprt,area,block,comprt){
            var fillSymbol_comprt = new SimpleFillSymbol({
                color: [0, 255, 127, 0.2],
                outline: {
                    color: [0, 255, 127],
                    width: 1
                }
            });
            var fillSymbol_block = new SimpleFillSymbol({
                color: [0, 0, 0, 0],
                outline: {
                    color: [65, 105, 225],
                    width: 2
                }
            });
            var temp_polygon_comprt = new Polygon({
                rings: [cur_comprt]
            });
            var temp_polygon_block = new Polygon({
                rings: [cur_block]
            });
            var trees = Math.round(Math.random()*1000)+1500;
            var ill_trees = Math.round(Math.random()*100);
            var pertemp = Math.round((ill_trees/trees)*100)/100;
            var attr_Comprt = {
                Area: area,
                Block: block,
                Comprt: comprt,
                Tree_name: "棕榈树",
                Tree_count: trees,
                Ill_Tree_count: ill_trees,
                ILL_percent: pertemp+"%"
            };

            var popupTemp_Comprt = {
                title: "{Area}地块{Block}区域{Comprt}",
                content: "<h5>树种：{Tree_name}</h5>" +
                "<h5>总数：{Tree_count}</h5>" +
                "<h5>病数：{Ill_Tree_count}</h5>" +
                "<h5>比例：{ILL_percent}</h5>"
            };
            var temp_polygonGraphic_comprt = new Graphic({
                geometry: temp_polygon_comprt,
                symbol: fillSymbol_comprt,
                attributes: attr_Comprt,
                popupTemplate: popupTemp_Comprt
            });
            var temp_polygonGraphic_block = new Graphic({
                geometry: temp_polygon_block,
                symbol: fillSymbol_block
            });
            mainView.graphics.removeAll();
            mainView.graphics.add(temp_polygonGraphic_block);
            mainView.graphics.add(temp_polygonGraphic_comprt);
        }


        mainView.then(function() {

        });

        // Create the MapView for overview map
        var mapView = new MapView({
            container: "overviewDiv",
            map: overviewMap
        });

        // Remove the default widgets
        mapView.ui.components = [];

        var extentDiv = dom.byId("extentDiv");

        mapView.then(function() {
            // Update the overview extent whenever the MapView or SceneView extent changes
            mainView.watch("extent", updateOverviewExtent);
            mapView.watch("extent", updateOverviewExtent);

            // Update the minimap overview when the main view becomes stationary
            watchUtils.when(mainView, "stationary", updateOverview);

            function updateOverview() {
                // Animate the MapView to a zoomed-out scale so we get a nice overview.
                // We use the "progress" call back of the goTo promise to update
                // the overview extent while animating
                mapView.goTo({
                    center: mainView.center,
                    scale: mainView.scale * 2 * Math.max(mainView.width /
                        mapView.width,
                        mainView.height / mapView.height)
                });
            }

            function updateOverviewExtent() {
                // Update the overview extent by converting the SceneView extent to the
                // MapView screen coordinates and updating the extentDiv position.
                var extent = mainView.extent;

                var bottomLeft = mapView.toScreen(extent.xmin, extent.ymin);
                var topRight = mapView.toScreen(extent.xmax, extent.ymax);

                extentDiv.style.top = topRight.y + "px";
                extentDiv.style.left = bottomLeft.x + "px";

                extentDiv.style.height = (bottomLeft.y - topRight.y) + "px";
                extentDiv.style.width = (topRight.x - bottomLeft.x) + "px";
            }
        });
        // Create a BasemapGallery widget instance and set
        // its container to a div element

        var basemapGallery = new BasemapGallery({
            view: mainView,
            container: document.createElement("div")
        });

        // Create an Expand instance and set the content
        // property to the DOM node of the basemap gallery widget
        // Use an Esri icon font to represent the content inside
        // of the Expand widget

        var bgExpand = new Expand({
            view: mainView,
            content: basemapGallery.domNode,
            expandIconClass: "esri-icon-basemap"
        });

        // Add the expand instance to the ui

        mainView.ui.add(bgExpand, "top-right");

        on(dojo.query("#Demo_Area_Boluo"), "click", function() {
            mainView.goTo({position: [114.197,23.0752,2000], heading: 0, tilt: 70});
            add_polygon_area(area_BL);
        });
        on(dojo.query("#Demo_Area_Zhangjk"), "click", function() {
            mainView.goTo({position: [114.92863,40.7802,2000], heading: 0, tilt: 70});
            add_polygon_area(area_ZJK);
        });
        on(dojo.query("#Demo_Area_Zhaoguang"), "click", function() {
            mainView.goTo({position: [126.927,46.4672,50000], heading: 0, tilt: 70});
            add_polygon_area(area_ZG);
        });
        on(dojo.query("#Demo_Area_Xinjiang"), "click", function() {
            mainView.goTo({position: [87.3060,43.8646,2000], heading: 0, tilt: 70});
            add_polygon_area(area_XJ);
        });

		on(dojo.query("#Demo_Area_Boluo_A"), "click", function() {
            mainView.goTo({position: [114.19452, 23.12866,1500], heading: 0, tilt: 0});
            add_polygon_block(block_BL_A);
        });
        on(dojo.query("#Demo_Area_Boluo_B"), "click", function() {
            mainView.goTo({position: [114.20026, 23.12347,1500], heading: 0, tilt: 0});
            add_polygon_block(block_BL_B);
        });
        on(dojo.query("#Demo_Area_Boluo_C"), "click", function() {
            mainView.goTo({position: [114.19575, 23.12343,1500], heading: 0, tilt: 0});
            add_polygon_block(block_BL_C);
        });
		on(dojo.query("#Demo_Area_Boluo_A_outline"), "click", function() {
            add_polygon_block_nocolor(block_BL_A);
        });
        on(dojo.query("#Demo_Area_Boluo_B_outline"), "click", function() {
            add_polygon_block_nocolor(block_BL_B);
        });
        on(dojo.query("#Demo_Area_Boluo_C_outline"), "click", function() {
            add_polygon_block_nocolor(block_BL_C);
        });

        on(dojo.query("#Demo_Comprt_Boluo_A_01_loc"), "click", function() {
            add_polygon_comprt(block_BL_A,Comprt_BL_A[0],"博罗县罗阳镇","A","01");
            add_ill_tree(114.19243, 23.12973);
            add_ill_tree(114.19294, 23.12972);
            add_ill_tree(114.19349, 23.13043);
        });
        on(dojo.query("#Demo_Comprt_Boluo_A_02_loc"), "click", function() {
            add_polygon_comprt(block_BL_A,Comprt_BL_A[1],"博罗县罗阳镇","A","02");
            add_ill_tree(114.19428,  23.12964);
            add_ill_tree(114.19405,  23.13031);
        });
        on(dojo.query("#Demo_Comprt_Boluo_A_03_loc"), "click", function() {
            add_polygon_comprt(block_BL_A,Comprt_BL_A[2],"博罗县罗阳镇","A","03");
			add_ill_tree(114.19585,  23.13047);
			add_ill_tree(114.19656,  23.13022);
			add_ill_tree(114.19612,  23.12977);
        });
        on(dojo.query("#Demo_Comprt_Boluo_A_04_loc"), "click", function() {
            add_polygon_comprt(block_BL_A,Comprt_BL_A[3],"博罗县罗阳镇","A","04");
			add_ill_tree(114.19735,  23.13074);
        });
        on(dojo.query("#Demo_Comprt_Boluo_A_05_loc"), "click", function() {
            add_polygon_comprt(block_BL_A,Comprt_BL_A[4],"博罗县罗阳镇","A","05");
			add_ill_tree(114.19344,  23.12913);
			add_ill_tree(114.19253,  23.12913);
			add_ill_tree(114.19277,  23.12864);
			add_ill_tree(114.19324,  23.12834);
			add_ill_tree(114.19217,  23.12826);
			add_ill_tree(114.19354,  23.12935)
        });
        on(dojo.query("#Demo_Comprt_Boluo_A_06_loc"), "click", function() {
            add_polygon_comprt(block_BL_A,Comprt_BL_A[5],"博罗县罗阳镇","A","06");
			add_ill_tree(114.19468,  23.12914);
			add_ill_tree(114.19388,  23.12919);
        });
        on(dojo.query("#Demo_Comprt_Boluo_A_07_loc"), "click", function() {
            add_polygon_comprt(block_BL_A,Comprt_BL_A[6],"博罗县罗阳镇","A","07");
			add_ill_tree(114.19211,  23.12766);
			add_ill_tree(114.19272,  23.1274);
			add_ill_tree(114.19217,  23.12694);
        });

        on(dojo.query("#Demo_Comprt_Boluo_B_01_loc"), "click", function() {
            add_polygon_comprt(block_BL_B,Comprt_BL_B[0],"博罗县罗阳镇","B","01");
            add_ill_tree(114.2011, 23.12543);
            add_ill_tree( 114.20189, 23.12455);
        });
        on(dojo.query("#Demo_Comprt_Boluo_B_02_loc"), "click", function() {
            add_polygon_comprt(block_BL_B,Comprt_BL_B[1],"博罗县罗阳镇","B","02");
            add_ill_tree(114.19921, 23.12353 );
            add_ill_tree(114.1995, 23.12318);
        });
        on(dojo.query("#Demo_Comprt_Boluo_B_03_loc"), "click", function() {
            add_polygon_comprt(block_BL_B,Comprt_BL_B[2],"博罗县罗阳镇","B","03");
            add_ill_tree(114.20127, 23.12309);
        });
        on(dojo.query("#Demo_Comprt_Boluo_B_04_loc"), "click", function() {
            add_polygon_comprt(block_BL_B,Comprt_BL_B[3],"博罗县罗阳镇","B","04");
            add_ill_tree(114.19909, 23.1221);
            add_ill_tree(114.1993, 23.12213);
            add_ill_tree( 114.19942, 23.12189);
            add_ill_tree(114.19937, 23.12167 );
            add_ill_tree(114.19983, 23.12165);
        });
        on(dojo.query("#Demo_Comprt_Boluo_B_05_loc"), "click", function() {
            add_polygon_comprt(block_BL_B,Comprt_BL_B[4],"博罗县罗阳镇","B","05");

            add_ill_tree(114.20145, 23.12204);
        });

        on(dojo.query("#Demo_Comprt_Boluo_C_01_loc"), "click", function() {
            add_polygon_comprt(block_BL_C,Comprt_BL_C[0],"博罗县罗阳镇","C","01");
            add_ill_tree( 114.19511, 23.12484 );
            add_ill_tree(114.1956, 23.12524);
        });
        on(dojo.query("#Demo_Comprt_Boluo_C_02_loc"), "click", function() {
            add_polygon_comprt(block_BL_C,Comprt_BL_C[1],"博罗县罗阳镇","C","02");
            add_ill_tree(114.19605, 23.12344);
            add_ill_tree(114.19626, 23.1234);
            add_ill_tree(114.19649, 23.1233);
        });
        on(dojo.query("#Demo_Comprt_Boluo_C_03_loc"), "click", function() {
            add_polygon_comprt(block_BL_C,Comprt_BL_C[2],"博罗县罗阳镇","C","03");
            add_ill_tree(114.19534, 23.122180);
        });

        //add_polygon_block
        on(dojo.query("#Demo_Area_Zhangjk_A"), "click", function() {
            mainView.goTo({position: [114.92974, 40.82734,2000], heading: 0, tilt: 0});
            add_polygon_block(block_ZJK_A);
        });
		on(dojo.query("#Demo_Area_Zhangjk_A_outline"), "click", function() {
            add_polygon_block_nocolor(block_ZJK_A);
        });
        on(dojo.query("#Demo_Comprt_Zhangjk_A_01_loc"), "click", function() {
            add_polygon_comprt(block_ZJK_A,Comprt_ZJK_A[0]);
        });
        on(dojo.query("#Demo_Comprt_Zhangjk_A_02_loc"), "click", function() {
            add_polygon_comprt(block_ZJK_A,Comprt_ZJK_A[1]);
        });
        on(dojo.query("#Demo_Comprt_Zhangjk_A_03_loc"), "click", function() {
            add_polygon_comprt(block_ZJK_A,Comprt_ZJK_A[2]);
        });
        on(dojo.query("#Demo_Comprt_Zhangjk_A_04_loc"), "click", function() {
            add_polygon_comprt(block_ZJK_A,Comprt_ZJK_A[3]);
        });


        on(dojo.query("#Demo_Area_Zhaoguang_A"), "click", function() {
            add_polygon_block(block_ZG_A);
            mainView.goTo({position: [126.89554, 48.0807,4000], heading: 0, tilt: 0});
        });
		on(dojo.query("#Demo_Area_Zhaoguang_A_outline"), "click", function() {
            add_polygon_block_nocolor(block_ZG_A);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_A_01_loc"), "click", function() {
            add_polygon_comprt(block_ZG_A,Comprt_ZG_A[0]);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_A_02_loc"), "click", function() {
            add_polygon_comprt(block_ZG_A,Comprt_ZG_A[1]);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_A_03_loc"), "click", function() {
            add_polygon_comprt(block_ZG_A,Comprt_ZG_A[2]);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_A_04_loc"), "click", function() {
            add_polygon_comprt(block_ZG_A,Comprt_ZG_A[3]);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_A_05_loc"), "click", function() {
            add_polygon_comprt(block_ZG_A,Comprt_ZG_A[4]);
        });

        on(dojo.query("#Demo_Area_Zhaoguang_B"), "click", function() {
            add_polygon_block(block_ZG_B);
            mainView.goTo({position: [126.45159, 48.04779,4000], heading: 0, tilt: 0});
        });
		on(dojo.query("#Demo_Area_Zhaoguang_B_outline"), "click", function() {
            add_polygon_block_nocolor(block_ZG_B);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_B_01_loc"), "click", function() {
            add_polygon_comprt(block_ZG_B,Comprt_ZG_B[0]);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_B_02_loc"), "click", function() {
            add_polygon_comprt(block_ZG_B,Comprt_ZG_B[1]);
        });
        on(dojo.query("#Demo_Comprt_Zhaoguang_B_03_loc"), "click", function() {
            add_polygon_comprt(block_ZG_B,Comprt_ZG_B[2]);
        });

        on(dojo.query("#Demo_Area_Xinjiang_A"), "click", function() {
            add_polygon_block(block_XJ_A);
            mainView.goTo({position: [87.3060,43.9026,2000], heading: 0, tilt: 0});
        });
		on(dojo.query("#Demo_Area_Xinjiang_A_outline"), "click", function() {
            add_polygon_block_nocolor(block_XJ_A);
        });
        on(dojo.query("#Demo_Comprt_Xinjiang_A_01_loc"), "click", function() {
            add_polygon_comprt(block_XJ_A,Comprt_XJ_A[0]);
        });
        on(dojo.query("#Demo_Comprt_Xinjiang_A_02_loc"), "click", function() {
            add_polygon_comprt(block_XJ_A,Comprt_XJ_A[1]);
        });
        on(dojo.query("#Demo_Comprt_Xinjiang_A_03_loc"), "click", function() {
            add_polygon_comprt(block_XJ_A,Comprt_XJ_A[2]);
        });

        mainView.on('click', function(evt){
           if(evt.mapPoint){
               var x = Math.round(evt.mapPoint.longitude * 100000)/100000;
               var y = Math.round(evt.mapPoint.latitude * 100000)/100000;
               var z = Math.round(evt.mapPoint.z * 100)/100;
               document.getElementById("curcordDiv").innerHTML = '鼠标单击位置：经纬度( ' + x + ', ' + y + ' ), 海拔' + z + 'm';
           }
        });

        istoGround = false;
        on(dojo.query("#toGround"), "click", updateElevation);

        function updateElevation(ev) {

          // Turn ground layers visibility on/off
          mainMap.ground.layers.forEach(function(layer) {
            layer.visible = istoGround;
              if(!istoGround){
                  istoGround = true;
              }else if(istoGround){
                  istoGround = false;
              }else{
                  istoGround = undefined
              }
          });
        }

    });

    </script>

</head>

<body>
    <div id="viewDiv">
    </div>
    {% include 'OptionDiv.html' %}
    <div id="curcordDiv">
        <p>鼠标单击位置：经纬度( ---.----, ---.---- ), 海拔---.--m</p>
    </div>
    <div id="overviewDiv">
        <div id="extentDiv"></div>
    </div>
    {% include 'LIstDiv.html' %}

</body>
</html>